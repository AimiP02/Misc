import matplotlib.pyplot as plt

train_loss = []
test_loss = []
train_acc = []
test_acc = []

with open("./checkpoint.txt", "r") as f:
    for line in f.readlines():
        line = line.split(" ")
        epoch = line[1].split(",")[0]
        train_loss_data = line[4].split(",")[0]
        test_loss_data = line[7].split(",")[0]
        train_acc_data = line[10].split(",")[0]
        test_acc_data = line[-1].strip("\n")
        train_loss.append(float(train_loss_data))
        test_loss.append(float(test_loss_data))
        train_acc.append(float(train_acc_data))
        test_acc.append(float(test_acc_data))
        
# 输出100轮epoch的训练集和测试集的loss曲线

plt.figure(figsize=(10, 10))
plt.plot(range(100), train_loss, label="train_loss")
plt.plot(range(100), test_loss, label="test_loss")
plt.legend()
plt.xlabel("epoch")
plt.ylabel("loss")
plt.show()
plt.savefig("loss.png")

# 输出100轮epoch的训练集和测试集的acc曲线

plt.figure(figsize=(10, 10))
plt.plot(range(100), train_acc, label="train_acc")
plt.plot(range(100), test_acc, label="test_acc")
plt.legend()
plt.xlabel("epoch")
plt.ylabel("acc")
plt.show()
plt.savefig("acc.png")